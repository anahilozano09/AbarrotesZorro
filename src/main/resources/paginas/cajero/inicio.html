<!-- src/main/resources/paginas/cajero/inicio.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6"
      lang="es">
<head th:replace="plantillas/plantilla :: head"></head>
<body>

<header th:replace="plantillas/plantilla :: header"></header>

<main class="container mt-4">

  <h2 class="mb-4 text-center">Realizar Compra</h2>

  <!-- Buscar cliente -->
  <form th:action="@{/cajero/buscar-cliente}" method="post" class="mb-4">
    <div class="input-group">
      <input type="text" name="numCuenta" class="form-control" placeholder="Número de cuenta del cliente" required>
      <button class="btn btn-primary" type="submit">Buscar Cliente</button>
    </div>
  </form>

  <!-- Si no existe el cliente, mostrar formulario para registrarlo -->
  <div th:if="${clienteNoEncontrado}">
    <h5>Registrar nuevo cliente</h5>
    <form th:action="@{/cajero/registrar-cliente}" method="post">
      <input type="hidden" name="numCuenta" th:value="${numCuenta}">
      <div class="mb-2">
        <input type="text" name="nombre" placeholder="Nombre completo" class="form-control" required>
      </div>
      <div class="mb-2">
        <input type="email" name="email" placeholder="Correo electrónico" class="form-control" required>
      </div>
      <div class="mb-2">
        <input type="text" name="telefono" placeholder="Teléfono" class="form-control" required>
      </div>
      <button type="submit" class="btn btn-success">Registrar Cliente</button>
    </form>
  </div>

  <!-- Si existe el cliente, mostrar formulario de compra -->
  <div th:if="${cliente}">
    <h5>Cliente: <span th:text="${cliente.nombre}"></span></h5>

    <form th:action="@{/cajero/guardar-compra}" method="post" class="mt-3">
      <input type="hidden" name="idCliente" th:value="${cliente.id_clien}">

      <div class="mb-2">
        <label for="producto">Producto:</label>
        <select name="idProducto" id="producto" class="form-select" required>
          <option th:each="producto : ${productos}"
                  th:value="${producto.id_pro}"
                  th:text="${producto.nombre} + ' ($' + ${producto.precio} + ')'">
          </option>
        </select>
      </div>

      <div class="mb-2">
        <label for="cantidad">Cantidad:</label>
        <input type="number" min="1" name="cantidad" class="form-control" required>
      </div>

      <button type="submit" class="btn btn-primary">Registrar Compra</button>
    </form>
  </div>

</main>

<footer th:replace="plantillas/plantilla :: footer"></footer>

</body>
</html>
